<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Feature-Based Forecast Model Selection  • seer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Feature-Based Forecast Model Selection ">
<meta property="og:description" content="A novel meta-learning framework for forecast model selection using time series features. Many applications require a large number of time series to be forecast. Providing better forecasts for these time series is important in decision and policy making. We propose a classification framework which selects forecast models based on features calculated from the time series. We call this framework FFORMS (Feature-based FORecast Model Selection). FFORMS builds a mapping that relates the features of time series to the best forecast model using a random forest. seer package is the implementation of the FFORMS algorithm. For more details see our paper at &lt;https://www.monash.edu/business/econometrics-and-business-statistics/research/publications/ebs/wp06-2018.pdf&gt;.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">seer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="seer" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#seer" class="anchor"></a>seer <img src="logo/seer.png" align="right" height="200">
</h1></div>

<hr>
<p>The <code>seer</code> package provides implementations of a novel framework for forecast model selection using time series features. We call this framework <strong>FFORMS</strong> (<strong>F</strong>eature-based <strong>FOR</strong>ecast <strong>M</strong>odel <strong>S</strong>election). For more details see our <a href="https://www.monash.edu/business/econometrics-and-business-statistics/research/publications/ebs/wp06-2018.pdf">paper</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You could install the stable version on CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"seer"</span>)</a></code></pre></div>
<p>You could install the development version from Github using</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"thiyangt/seer"</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(seer)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>The FFORMS framework consists of two main phases: i) offline phase, which includes the development of a classification model and ii) online phase, use the classification model developed in the offline phase to identify “best” forecast-model. This document explains the main functions using a simple dataset based on M3-competition data. To load data,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Mcomp)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(M3)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">yearly_m3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(M3, <span class="st">"yearly"</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">m3y &lt;-<span class="st"> </span>M3[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a></code></pre></div>
<div id="fforms-offline-phase" class="section level4">
<h4 class="hasAnchor">
<a href="#fforms-offline-phase" class="anchor"></a>FFORMS: offline phase</h4>
<p><strong>1. Augmenting the observed sample with simulated time series.</strong></p>
<p>We augment our reference set of time series by simulating new time series. In order to produce simulated series, we use several standard automatic forecasting algorithms such as ETS or automatic ARIMA models, and then simulate multiple time series from the selected model within each model class. <code>sim_arimabased</code> can be used to simulate time series based on (S)ARIMA models.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(seer)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">simulated_arima &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(m3y, sim_arimabased, <span class="dt">Future=</span><span class="ot">TRUE</span>, <span class="dt">Nsim=</span><span class="dv">2</span>, <span class="dt">extralength=</span><span class="dv">6</span>, <span class="dt">Combine=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">simulated_arima</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; $N0001</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; $N0001[[1]]</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; Time Series:</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; Start = 1989 </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; End = 2008 </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; Frequency = 1 </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  [1]  5673.368  6505.846  7377.933  8075.145  8867.308  9719.320 10784.489</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  [8] 11913.280 13054.743 14332.860 15626.031 16813.841 17925.602 19067.667</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; [15] 20199.325 21304.479 22367.024 23320.402 24384.861 25548.974</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; $N0001[[2]]</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; Time Series:</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; Start = 1989 </span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; End = 2008 </span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; Frequency = 1 </span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;  [1]  5447.957  6001.848  6554.986  6996.311  7494.173  8115.887  8586.807</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;  [8]  9072.484  9442.238  9878.042 10326.372 10864.714 11456.818 11989.174</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; [15] 12461.835 12972.509 13358.738 13778.490 14093.503 14259.098</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; $N0002</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; $N0002[[1]]</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; Time Series:</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; Start = 1989 </span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; End = 2008 </span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; Frequency = 1 </span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt;  [1] 4596.758 3424.029 3735.812 2396.637 2687.153 3157.678 3926.807 4690.093</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt;  [9] 3925.642 4951.901 5048.185 5013.224 4989.674 4097.347 4628.474 5262.582</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt; [17] 6809.380 6917.600 8263.714 9508.266</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt; $N0002[[2]]</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt; Time Series:</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt; Start = 1989 </span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt; End = 2008 </span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt; Frequency = 1 </span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt;  [1] 3483.514 4041.950 3804.734 4639.967 5446.569 5951.361 6436.684 6474.653</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt;  [9] 6106.708 6431.084 6386.627 4044.271 4812.637 3663.215 2910.945 2591.194</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt; [17] 2769.579 3559.140 3086.361 4147.651</span></a></code></pre></div>
<p>Similarly, <code>sim_etsbased</code> can be used to simulate time series based on ETS models.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">simulated_ets &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(m3y, sim_etsbased, <span class="dt">Future=</span><span class="ot">TRUE</span>, <span class="dt">Nsim=</span><span class="dv">2</span>, <span class="dt">extralength=</span><span class="dv">6</span>, <span class="dt">Combine=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">simulated_ets</a></code></pre></div>
<p><strong>2. Calculate features based on the training period of time series.</strong></p>
<p>Our proposed framework operates on the features of the time series. <code>cal_features</code> function can be used to calculate relevant features for a given list of time series.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tsfeatures)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">M3yearly_features &lt;-<span class="st"> </span>seer<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/seer/man/cal_features.html">cal_features</a></span>(yearly_m3, <span class="dt">database=</span><span class="st">"M3"</span>, <span class="dt">h=</span><span class="dv">6</span>, <span class="dt">highfreq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(M3yearly_features)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; # A tibble: 6 x 25</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt;   entropy lumpiness stability hurst trend spikiness linearity curvature e_acf1</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; 1   0.773         0         0 0.971 0.995   2.37e-7     3.58      0.424  0.412</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; 2   0.837         0         0 0.947 0.869   1.79e-4     2.05     -2.08   0.324</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; 3   0.825         0         0 0.949 0.865   1.93e-4     1.75     -2.26   0.457</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; 4   0.854         0         0 0.949 0.853   3.68e-4     2.87     -1.25   0.281</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 5   0.899         0         0 0.855 0.586   1.27e-3    -0.765    -1.77   0.192</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 6   0.798         0         0 0.964 0.964   2.17e-5     3.56     -0.574  0.181</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; # … with 16 more variables: y_acf1 &lt;dbl&gt;, diff1y_acf1 &lt;dbl&gt;, diff2y_acf1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; #   y_pacf5 &lt;dbl&gt;, diff1y_pacf5 &lt;dbl&gt;, diff2y_pacf5 &lt;dbl&gt;, nonlinearity &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; #   lmres_acf1 &lt;dbl&gt;, ur_pp &lt;dbl&gt;, ur_kpss &lt;dbl&gt;, N &lt;int&gt;, y_acf5 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; #   diff1y_acf5 &lt;dbl&gt;, diff2y_acf5 &lt;dbl&gt;, alpha &lt;dbl&gt;, beta &lt;dbl&gt;</span></a></code></pre></div>
<p><strong>Calculate features from the simulated time series in the step 1</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">features_simulated_arima &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(simulated_arima, <span class="cf">function</span>(temp){</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">    <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(temp, cal_features, <span class="dt">h=</span><span class="dv">6</span>, <span class="dt">database=</span><span class="st">"other"</span>, <span class="dt">highfreq=</span><span class="ot">FALSE</span>)})</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">fea_sim &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(features_simulated_arima, <span class="cf">function</span>(temp){<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(rbind, temp)})</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(rbind, fea_sim)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; # A tibble: 4 x 25</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;   entropy lumpiness stability hurst trend spikiness linearity curvature  e_acf1</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; *   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; 1   0.768         0         0 0.973 0.999   1.73e-9     3.57     0.265   0.719 </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; 2   0.769         0         0 0.972 0.999   2.75e-9     3.61    -0.0203  0.427 </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; 3   0.915         0         0 0.873 0.692   5.16e-4     1.56     0.666   0.0642</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; 4   0.887         0         0 0.908 0.841   3.22e-4     0.612   -2.63   -0.185 </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; # … with 16 more variables: y_acf1 &lt;dbl&gt;, diff1y_acf1 &lt;dbl&gt;, diff2y_acf1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; #   y_pacf5 &lt;dbl&gt;, diff1y_pacf5 &lt;dbl&gt;, diff2y_pacf5 &lt;dbl&gt;, nonlinearity &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; #   lmres_acf1 &lt;dbl&gt;, ur_pp &lt;dbl&gt;, ur_kpss &lt;dbl&gt;, N &lt;int&gt;, y_acf5 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; #   diff1y_acf5 &lt;dbl&gt;, diff2y_acf5 &lt;dbl&gt;, alpha &lt;dbl&gt;, beta &lt;dbl&gt;</span></a></code></pre></div>
<p><strong>3. Calculate forecast accuracy measure(s)</strong></p>
<p><code>fcast_accuracy</code> function can be used to calculate forecast error measure (in the following example MASE) from each candidate model. This step is the most computationally intensive and time-consuming, as each candidate model has to be estimated on each series. In the following example ARIMA(arima), ETS(ets), random walk(rw), random walk with drift(rwd), standard theta method(theta) and neural network time series forecasts(nn) are used as possible models. In addition to these models following models can also be used in the case of handling seasonal time series,</p>
<ul>
<li>snaive: seasonal naive method</li>
<li>stlar: STL decomposition is applied to the time series and then seasonal naive method is used to forecast seasonal component. AR model is used to forecast seasonally adjusted data.</li>
<li>mstlets: STL decomposition is applied to the time series and then seasonal naive method is used to forecast seasonal component. ETS model is used to forecast seasonally adjusted data.</li>
<li>mstlarima: STL decomposition is applied to the time series and then seasonal naive method is used to forecast seasonal component. ARIMA model is used to forecast seasonally adjusted data.</li>
<li>tbats: TBATS models</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">tslist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(M3[[<span class="dv">1</span>]], M3[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">accuracy_info &lt;-<span class="st"> </span><span class="kw"><a href="reference/fcast_accuracy.html">fcast_accuracy</a></span>(<span class="dt">tslist=</span>tslist, <span class="dt">models=</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"arima"</span>,<span class="st">"ets"</span>,<span class="st">"rw"</span>,<span class="st">"rwd"</span>, <span class="st">"theta"</span>, <span class="st">"nn"</span>), <span class="dt">database =</span><span class="st">"M3"</span>, cal_MASE, <span class="dt">h=</span><span class="dv">6</span>, <span class="dt">length_out =</span> <span class="dv">1</span>, <span class="dt">fcast_save =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">accuracy_info</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; $accuracy</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt;         arima       ets       rw       rwd    theta       nn</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; [1,] 1.566974 1.5636089 7.703518 4.2035176 6.017236 2.364307</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; [2,] 1.698388 0.9229687 1.698388 0.6123443 1.096000 0.279762</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; $ARIMA</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; [1] "ARIMA(0,2,0)" "ARIMA(0,1,0)"</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; $ETS</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; [1] "ETS(M,A,N)" "ETS(M,A,N)"</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; $forecasts</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; $forecasts$arima</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;         [,1] [,2]</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; [1,] 5486.10 4230</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; [2,] 6035.21 4230</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; [3,] 6584.32 4230</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; [4,] 7133.43 4230</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; [5,] 7682.54 4230</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; [6,] 8231.65 4230</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; $forecasts$ets</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt;          [,1]     [,2]</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; [1,] 5486.429 4347.678</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; [2,] 6035.865 4465.365</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt; [3,] 6585.301 4583.052</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; [4,] 7134.737 4700.738</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; [5,] 7684.173 4818.425</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt; [6,] 8233.609 4936.112</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; $forecasts$rw</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt;         [,1] [,2]</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; [1,] 4936.99 4230</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; [2,] 4936.99 4230</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; [3,] 4936.99 4230</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; [4,] 4936.99 4230</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; [5,] 4936.99 4230</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt; [6,] 4936.99 4230</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; $forecasts$rwd</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt;         [,1]     [,2]</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt; [1,] 5244.40 4402.227</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt; [2,] 5551.81 4574.454</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt; [3,] 5859.22 4746.681</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt; [4,] 6166.63 4918.908</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="co">#&gt; [5,] 6474.04 5091.135</span></a>
<a class="sourceLine" id="cb8-50" data-line-number="50"><span class="co">#&gt; [6,] 6781.45 5263.362</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="co">#&gt; $forecasts$theta</span></a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="co">#&gt;         [,1]     [,2]</span></a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="co">#&gt; [1,] 5085.07 4321.416</span></a>
<a class="sourceLine" id="cb8-55" data-line-number="55"><span class="co">#&gt; [2,] 5233.19 4412.843</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56"><span class="co">#&gt; [3,] 5381.31 4504.269</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57"><span class="co">#&gt; [4,] 5529.43 4595.696</span></a>
<a class="sourceLine" id="cb8-58" data-line-number="58"><span class="co">#&gt; [5,] 5677.55 4687.122</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59"><span class="co">#&gt; [6,] 5825.67 4778.549</span></a>
<a class="sourceLine" id="cb8-60" data-line-number="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61"><span class="co">#&gt; $forecasts$nn</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="co">#&gt;          [,1]     [,2]</span></a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="co">#&gt; [1,] 5516.268 4791.329</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64"><span class="co">#&gt; [2,] 6080.209 5061.319</span></a>
<a class="sourceLine" id="cb8-65" data-line-number="65"><span class="co">#&gt; [3,] 6573.429 5151.868</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66"><span class="co">#&gt; [4,] 6956.673 5177.679</span></a>
<a class="sourceLine" id="cb8-67" data-line-number="67"><span class="co">#&gt; [5,] 7223.294 5184.657</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68"><span class="co">#&gt; [6,] 7393.063 5186.516</span></a></code></pre></div>
<p><strong>4. Construct a dataframe of input:features and output:lables to train a random forest</strong></p>
<p><code>prepare_trainingset</code> can be used to create a data frame of input:features and output: labels.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># steps 3 and 4 applied to yearly series of M1 competition</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(M1)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">yearly_m1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(M1, <span class="st">"yearly"</span>)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">accuracy_m1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fcast_accuracy.html">fcast_accuracy</a></span>(<span class="dt">tslist=</span>yearly_m1, <span class="dt">models=</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"arima"</span>,<span class="st">"ets"</span>,<span class="st">"rw"</span>,<span class="st">"rwd"</span>, <span class="st">"theta"</span>, <span class="st">"nn"</span>), <span class="dt">database =</span><span class="st">"M1"</span>, cal_MASE, <span class="dt">h=</span><span class="dv">6</span>, <span class="dt">length_out =</span> <span class="dv">1</span>, <span class="dt">fcast_save =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">features_m1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/cal_features.html">cal_features</a></span>(yearly_m1, <span class="dt">database=</span><span class="st">"M1"</span>, <span class="dt">h=</span><span class="dv">6</span>, <span class="dt">highfreq =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co"># prepare training set</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">prep_tset &lt;-<span class="st"> </span><span class="kw"><a href="reference/prepare_trainingset.html">prepare_trainingset</a></span>(<span class="dt">accuracy_set =</span> accuracy_m1, <span class="dt">feature_set =</span> features_m1)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co"># provides the training set to build a rf classifier</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(prep_tset<span class="op">$</span>trainingset)</a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; # A tibble: 6 x 26</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;   entropy lumpiness stability hurst trend spikiness linearity curvature  e_acf1</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; 1   0.683   0.0400      0.977 0.985 0.985   1.32e-6      4.46    0.705  -0.0603</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; 2   0.711   0.0790      0.894 0.988 0.989   1.54e-6      4.47    0.613   0.272 </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; 3   0.716   0.0160      0.858 0.987 0.989   1.13e-6      4.60    0.695   0.172 </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; 4   0.761   0.00201     1.32  0.982 0.957   8.96e-6      4.48    0.0735 -0.396 </span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; 5   0.628   0.00112     0.446 0.993 0.973   1.80e-6      5.77    1.21    0.0113</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; 6   0.708   0.00774     0.578 0.986 0.975   3.31e-6      4.75    0.748  -0.385 </span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; # … with 17 more variables: y_acf1 &lt;dbl&gt;, diff1y_acf1 &lt;dbl&gt;, diff2y_acf1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; #   y_pacf5 &lt;dbl&gt;, diff1y_pacf5 &lt;dbl&gt;, diff2y_pacf5 &lt;dbl&gt;, nonlinearity &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; #   lmres_acf1 &lt;dbl&gt;, ur_pp &lt;dbl&gt;, ur_kpss &lt;dbl&gt;, N &lt;int&gt;, y_acf5 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; #   diff1y_acf5 &lt;dbl&gt;, diff2y_acf5 &lt;dbl&gt;, alpha &lt;dbl&gt;, beta &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; #   classlabels &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co"># provides additional information about the fitted models</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(prep_tset<span class="op">$</span>modelinfo)</a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt;   ARIMA_name              ETS_name   min_label model_names            </span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt;   &lt;chr&gt;                   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;                  </span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt; 1 ARIMA(0,1,0) with drift ETS(A,A,N) ets       ETS(A,A,N)             </span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt; 2 ARIMA(0,1,1) with drift ETS(M,A,N) rwd       rwd                    </span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt; 3 ARIMA(0,1,2) with drift ETS(M,A,N) ets       ETS(M,A,N)             </span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; 4 ARIMA(1,1,0) with drift ETS(M,A,N) rwd       rwd                    </span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; 5 ARIMA(0,1,1) with drift ETS(M,A,N) arima     ARIMA(0,1,1) with drift</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt; 6 ARIMA(1,1,0) with drift ETS(M,A,N) ets       ETS(M,A,N)</span></a></code></pre></div>
</div>
<div id="fforms-online-phase-is-activated-" class="section level4">
<h4 class="hasAnchor">
<a href="#fforms-online-phase-is-activated-" class="anchor"></a>FFORMS: online phase is activated.</h4>
<p><strong>5. Train a random forest and predict class labels for new series (FFORMS: online phase)</strong></p>
<p><code>build_rf</code> in the <code>seer</code> package enables the training of a random forest model and predict class labels (“best” forecast-model) for new time series. In the following example we use only yearly series of the M1 and M3 competitions to illustrate the code. A random forest classifier is build based on the yearly series on M1 data and predicted class labels for yearly series in the M3 competition. Users can further add the features and classlabel information calculated based on the simulated time series.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">rf &lt;-<span class="st"> </span><span class="kw"><a href="reference/build_rf.html">build_rf</a></span>(<span class="dt">training_set =</span> prep_tset<span class="op">$</span>trainingset, <span class="dt">testset=</span>M3yearly_features,  <span class="dt">rf_type=</span><span class="st">"rcp"</span>, <span class="dt">ntree=</span><span class="dv">100</span>, <span class="dt">seed=</span><span class="dv">1</span>, <span class="dt">import=</span><span class="ot">FALSE</span>, <span class="dt">mtry =</span> <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; Warning in if (testset == FALSE) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co"># to get the predicted class labels</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">predictedlabels_m3 &lt;-<span class="st"> </span>rf<span class="op">$</span>predictions</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(predictedlabels_m3)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; predictedlabels_m3</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;                 ARIMA            ARMA/AR/MA       ETS-dampedtrend </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;                    66                     2                     0 </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; ETS-notrendnoseasonal             ETS-trend                    nn </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;                     4                    33                    11 </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;                    rw                   rwd                 theta </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;                     5                   515                     4 </span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;                    wn </span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;                     5</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co"># to obtain the random forest for future use</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19">randomforest &lt;-<span class="st"> </span>rf<span class="op">$</span>randomforest</a></code></pre></div>
<p><strong>6. Generate point foecasts and 95% prediction intervals</strong></p>
<p><code>rf_forecast</code> function can be used to generate point forecasts and 95% prediction intervals based on the predicted class labels obtained in step</p>
<ol><li>
</li></ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">forecasts &lt;-<span class="st"> </span><span class="kw"><a href="reference/rf_forecast.html">rf_forecast</a></span>(<span class="dt">predictions=</span>predictedlabels_m3[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">tslist=</span>yearly_m3[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">database=</span><span class="st">"M3"</span>, <span class="dt">function_name=</span><span class="st">"cal_MASE"</span>, <span class="dt">h=</span><span class="dv">6</span>, <span class="dt">accuracy=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co"># to obtain point forecasts</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">forecasts<span class="op">$</span>mean</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; [1,] 5486.429 6035.865 6585.301 7134.737 7684.173 8233.609</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; [2,] 4402.227 4574.454 4746.681 4918.908 5091.135 5263.362</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co"># to obtain lower boundary of 95% prediction intervals</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">forecasts<span class="op">$</span>lower</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; [1,] 4984.162 4893.098 4629.135 4199.745 3606.858 2848.873</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; [2,] 2941.377 2430.512 2028.738 1677.572 1355.680 1052.743</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co"># to obtain upper boundary of 95% prediction intervals</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">forecasts<span class="op">$</span>upper</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt;          [,1]     [,2]     [,3]      [,4]      [,5]     [,6]</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; [1,] 5988.696 7178.632 8541.467 10069.729 11761.488 13618.34</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt; [2,] 5863.077 6718.396 7464.623  8160.243  8826.589  9473.98</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co"># to obtain MASE</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22">forecasts<span class="op">$</span>accuracy</a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">#&gt; [1] 1.5636089 0.6123443</span></a></code></pre></div>
</div>
<div id="notes" class="section level4">
<h4 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h4>
<p><strong>Calculation of features for daily series</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># install.packages("https://github.com/carlanetto/M4comp2018/releases/download/0.2.0/M4comp2018_0.2.0.tar.gz",</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#                 repos=NULL)</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(M4comp2018)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(M4)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co"># extract first two daily time series</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">M4_daily &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/funprog.html">Filter</a></span>(<span class="cf">function</span>(l) l<span class="op">$</span>period <span class="op">==</span><span class="st"> "Daily"</span>, M4)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co"># convert daily series into msts objects</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">M4_daily_msts &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(M4_daily, <span class="cf">function</span>(temp){</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">  temp<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw"><a href="reference/convert_msts.html">convert_msts</a></span>(temp<span class="op">$</span>x, <span class="st">"daily"</span>)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(temp)</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">})</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co"># calculate features</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">seer<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/seer/man/cal_features.html">cal_features</a></span>(M4_daily_msts, <span class="dt">seasonal=</span><span class="ot">TRUE</span>, <span class="dt">h=</span><span class="dv">14</span>, <span class="dt">m=</span><span class="dv">7</span>, <span class="dt">lagmax=</span>8L, <span class="dt">database=</span><span class="st">"M4"</span>, <span class="dt">highfreq=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; # A tibble: 4,227 x 26</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt;    entropy lumpiness stability hurst trend spikiness linearity curvature e_acf1</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt;  1   0.327   0.00214     0.621 1.00  0.993  1.09e-10     31.1      3.09   0.976</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt;  2   0.369   0.331       0.446 1.00  0.865  2.53e- 8     24.7      1.35   0.986</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt;  3   0.659   0.755       0.761 0.999 0.917  4.49e- 6      3.82     4.89   0.318</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt;  4   0.819   0.168       0.821 0.996 0.841  3.86e- 6      1.87     6.38   0.290</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt;  5   0.512   0.0140      0.991 1.00  0.988  4.64e- 8     11.3      0.878  0.376</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt;  6   0.328   0.00136     0.242 1.00  0.989  1.90e-10     29.8      8.27   0.973</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt;  7   0.498   0.247       0.697 0.999 0.845  2.38e- 8     24.1      1.96   0.809</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt;  8   0.365   0.0189      1.01  1.00  0.968  2.31e- 9     30.1     -4.98   0.963</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt;  9   0.384   0.0275      1.07  1.00  0.954  4.69e- 9     29.3     -6.67   0.963</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; 10   0.509   0.00110     0.974 1.00  0.989  8.77e-10     18.3     -3.60   0.346</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt; # … with 4,217 more rows, and 17 more variables: y_acf1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt; #   diff1y_acf1 &lt;dbl&gt;, diff2y_acf1 &lt;dbl&gt;, y_pacf5 &lt;dbl&gt;, diff1y_pacf5 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"><span class="co">#&gt; #   diff2y_pacf5 &lt;dbl&gt;, nonlinearity &lt;dbl&gt;, seas_pacf &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co">#&gt; #   seasonal_strength1 &lt;dbl&gt;, seasonal_strength2 &lt;dbl&gt;, sediff_acf1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="co">#&gt; #   sediff_seacf1 &lt;dbl&gt;, sediff_acf5 &lt;dbl&gt;, N &lt;int&gt;, y_acf5 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="co">#&gt; #   diff1y_acf5 &lt;dbl&gt;, diff2y_acf5 &lt;dbl&gt;</span></a></code></pre></div>
<p><strong>Calculation of features for hourly series</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(M4)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># extract first two daily time series</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">M4_hourly &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/funprog.html">Filter</a></span>(<span class="cf">function</span>(l) l<span class="op">$</span>period <span class="op">==</span><span class="st"> "Hourly"</span>, M4)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">## convert data into msts object</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">hourlym4_msts &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(M4_hourly, <span class="cf">function</span>(temp){</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">    temp<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw"><a href="reference/convert_msts.html">convert_msts</a></span>(temp<span class="op">$</span>x, <span class="st">"hourly"</span>)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(temp)</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">})</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="reference/cal_features.html">cal_features</a></span>(hourlym4_msts, <span class="dt">seasonal=</span><span class="ot">TRUE</span>, <span class="dt">m=</span><span class="dv">24</span>, <span class="dt">lagmax=</span>25L, </a>
<a class="sourceLine" id="cb13-10" data-line-number="10">                                                         <span class="dt">database=</span><span class="st">"M4"</span>, <span class="dt">highfreq =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; Warning: Unknown columns: `seasonal_strength`</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; # A tibble: 2 x 26</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt;   entropy lumpiness stability hurst trend spikiness linearity curvature e_acf1</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; 1   0.524    0.0110    0.0899 0.999 0.626   1.92e-8      5.33    -3.51   0.958</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; 2   0.540    0.0505    0.109  0.999 0.790   6.39e-9      7.85    -0.152  0.974</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; # … with 17 more variables: y_acf1 &lt;dbl&gt;, diff1y_acf1 &lt;dbl&gt;, diff2y_acf1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt; #   y_pacf5 &lt;dbl&gt;, diff1y_pacf5 &lt;dbl&gt;, diff2y_pacf5 &lt;dbl&gt;, nonlinearity &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt; #   seas_pacf &lt;dbl&gt;, seasonal_strength1 &lt;dbl&gt;, seasonal_strength2 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">#&gt; #   sediff_acf1 &lt;dbl&gt;, sediff_seacf1 &lt;dbl&gt;, sediff_acf5 &lt;dbl&gt;, N &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#&gt; #   y_acf5 &lt;dbl&gt;, diff1y_acf5 &lt;dbl&gt;, diff2y_acf5 &lt;dbl&gt;</span></a></code></pre></div>
</div>
</div>
</div>
<div id="forecast-combinations-based-on-fforms-algorithm" class="section level1">
<h1 class="hasAnchor">
<a href="#forecast-combinations-based-on-fforms-algorithm" class="anchor"></a>Forecast combinations based on FFORMS algorithm</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># extract only the values for two time series just for illustration</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">yearly_m1_features &lt;-<span class="st"> </span>features_m1[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,]</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">votes.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(rf<span class="op">$</span>randomforest, yearly_m1_features, <span class="dt">type=</span><span class="st">"vote"</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">tslist &lt;-<span class="st"> </span>yearly_m1[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co"># To identify models and weights for forecast combination</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">models_and_weights_for_combinations &lt;-<span class="st"> </span><span class="kw"><a href="reference/fforms_ensemble.html">fforms_ensemble</a></span>(votes.matrix, <span class="dt">threshold=</span><span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co"># Compute combination forecast</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="kw"><a href="reference/fforms_combinationforecast.html">fforms_combinationforecast</a></span>(models_and_weights_for_combinations, tslist, <span class="st">"M1"</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; [[1]]$mean</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt;          [,1]   [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; [1,] 556280.7 594333 632385.3 670437.6 708489.9 746542.3</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; [[1]]$lower</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; [1,] 495633.6 530117.6 561088.8 588269.7 611931.4 632551.3</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt; [[1]]$upper</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt; [1,] 616927.8 658548.4 703681.8 752605.5 805048.5 860533.2</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#&gt; [[2]]$mean</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#&gt; [1,] 400921.2 417802.4 434683.5 451564.7 468445.9 485327.1</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#&gt; [[2]]$lower</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="co">#&gt; [1,] 357623.1 355193.4 356354.4 359252.9 363194.2 367833.3</span></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32"><span class="co">#&gt; [[2]]$upper</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span></a>
<a class="sourceLine" id="cb14-34" data-line-number="34"><span class="co">#&gt; [1,] 444219.3 480411.3 513012.7 543876.6 573697.6 602820.9</span></a></code></pre></div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=seer">https://​cloud.r-project.org/​package=seer</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Thiyanga Talagala <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0656-9789" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>Rob J Hyndman <br><small class="roles"> Thesis advisor, author </small> <a href="https://orcid.org/0000-0002-2140-5352" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>George Athanasopoulos <br><small class="roles"> Thesis advisor, author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=seer"><img src="http://www.r-pkg.org/badges/version/seer" alt="CRAN_Status_Badge"></a></li>
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active ? The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://travis-ci.org/thiyangt/seer"><img src="https://travis-ci.org/thiyangt/seer.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/gh/thiyangt/seer?branch=master"><img src="https://codecov.io/gh/thiyangt/seer/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Thiyanga Talagala, Rob J Hyndman, George Athanasopoulos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
